(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47a916f2"],{"28a5":function(t,e,i){i("214f")("split",2,function(t,e,s){"use strict";var a=i("aae3"),o=s,n=[].push,r="split",l="length",c="lastIndex";if("c"=="abbc"[r](/(b)*/)[1]||4!="test"[r](/(?:)/,-1)[l]||2!="ab"[r](/(?:ab)*/)[l]||4!="."[r](/(.?)(.?)/)[l]||"."[r](/()()/)[l]>1||""[r](/.?/)[l]){var h=void 0===/()??/.exec("")[1];s=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!a(t))return o.call(i,t,e);var s,r,d,m,p,u=[],g=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),b=0,f=void 0===e?4294967295:e>>>0,v=new RegExp(t.source,g+"g");h||(s=new RegExp("^"+v.source+"$(?!\\s)",g));while(r=v.exec(i)){if(d=r.index+r[0][l],d>b&&(u.push(i.slice(b,r.index)),!h&&r[l]>1&&r[0].replace(s,function(){for(p=1;p<arguments[l]-2;p++)void 0===arguments[p]&&(r[p]=void 0)}),r[l]>1&&r.index<i[l]&&n.apply(u,r.slice(1)),m=r[0][l],b=d,u[l]>=f))break;v[c]===r.index&&v[c]++}return b===i[l]?!m&&v.test("")||u.push(""):u.push(i.slice(b)),u[l]>f?u.slice(0,f):u}}else"0"[r](void 0,0)[l]&&(s=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(i,a){var o=t(this),n=void 0==i?void 0:i[e];return void 0!==n?n.call(i,o,a):s.call(String(o),i,a)},s]})},"72ff":function(t,e,i){},"94be":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"edit-info"},[i("h2",{staticClass:"title"},[t._v(t._s("修改客服消息"==t.$route.name?"修改客服消息":"新建客服消息"))]),i("Form",{staticClass:"form-group",attrs:{model:t.form,"label-position":"right","label-width":100}},[i("FormItem",{attrs:{label:"类型",prop:"type"}},[i("RadioGroup",{attrs:{type:"button"},on:{"on-change":t.changeType},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[i("Radio",{attrs:{label:1}},[t._v("文本")]),i("Radio",{attrs:{label:0}},[t._v("图文")]),i("Radio",{attrs:{label:2}},[t._v("图片")])],1)],1),0==t.type?i("Form",{attrs:{model:t.subForm,"label-position":"right","label-width":100}},[i("FormItem",{attrs:{label:"图片",prop:"picurl"}},[i("Upload",{attrs:{action:"http://test.oorggt.top/reply/upload","show-upload-list":!1,name:"imageFile","on-success":t.handleSuccess}},[i("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("点击上传")]),i("br"),t.imgUrl?i("img",{staticStyle:{"margin-top":"10px"},attrs:{src:t.imgUrl,alt:"",width:"200"}}):t._e()],1)],1),i("FormItem",{attrs:{label:"标题",prop:"title"}},[i("Input",{attrs:{size:"large",type:"text",placeholder:"请输入标题"},model:{value:t.subForm.title,callback:function(e){t.$set(t.subForm,"title",e)},expression:"subForm.title"}})],1),i("FormItem",{attrs:{label:"链接",prop:"url"}},[i("Input",{attrs:{size:"large",type:"text",placeholder:"请输入链接"},model:{value:t.subForm.url,callback:function(e){t.$set(t.subForm,"url",e)},expression:"subForm.url"}})],1),i("FormItem",{attrs:{label:"详细信息",prop:"description"}},[i("Input",{attrs:{size:"large",type:"textarea",placeholder:"请输入详细信息"},model:{value:t.subForm.description,callback:function(e){t.$set(t.subForm,"description",e)},expression:"subForm.description"}})],1),i("FormItem",[i("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"success"},on:{click:t.addOne}},[t._v("添加")]),i("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"primary"},on:{click:t.saveOne}},[t._v("保存")])],1),i("FormItem",{attrs:{label:"图文消息"}},[i("Table",{staticClass:"edit-message-table",attrs:{stripe:"",columns:t.editHeader,data:t.editData}})],1)],1):1==t.type?i("FormItem",{attrs:{label:"详细信息",prop:"description"}},[i("Input",{attrs:{size:"large",type:"textarea",placeholder:"请输入详细信息"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1):i("FormItem",{attrs:{label:"图片",prop:"picurl"}},[i("Upload",{attrs:{action:"http://test.oorggt.top/reply/upload","show-upload-list":!1,name:"imageFile","on-success":t.handleSuccess}},[i("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("点击上传")]),i("br"),t.imgUrl?i("img",{staticStyle:{"margin-top":"10px"},attrs:{src:t.imgUrl,alt:"",width:"200"}}):t._e()],1)],1),i("FormItem",{attrs:{label:"人工/延时/定时",prop:"channel"}},[i("RadioGroup",{attrs:{type:"button"},model:{value:t.channel,callback:function(e){t.channel=e},expression:"channel"}},[i("Radio",{attrs:{label:0}},[t._v("人工")]),i("Radio",{attrs:{label:1}},[t._v("延时")]),i("Radio",{attrs:{label:2}},[t._v("定时")])],1)],1),1==t.channel?i("FormItem",{attrs:{label:"延时时间(分钟)",prop:"delay"}},[i("Input",{staticStyle:{width:"180px"},attrs:{size:"large",type:"text",placeholder:"请输入延时时间(分钟)"},model:{value:t.delay,callback:function(e){t.delay=e},expression:"delay"}})],1):t._e(),2==t.channel?i("FormItem",{attrs:{label:"定时时间",prop:"timing_time"}},[i("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.timing_time,callback:function(e){t.timing_time=e},expression:"timing_time"}})],1):t._e(),i("FormItem",{attrs:{label:"类型",prop:"sex"}},[i("RadioGroup",{model:{value:t.sex,callback:function(e){t.sex=e},expression:"sex"}},[i("Radio",{attrs:{label:"all"}},[t._v("全部")]),i("Radio",{attrs:{label:"0"}},[t._v("未知")]),i("Radio",{attrs:{label:"1"}},[t._v("男")]),i("Radio",{attrs:{label:"2"}},[t._v("女")])],1)],1),i("FormItem",{attrs:{label:"选择标签",prop:"tagName"}},[t.tagName?i("Tag",{attrs:{name:t.tagName,closable:""},on:{"on-close":t.handleClose}},[t._v(t._s(t.tagName))]):t._e()],1),i("FormItem",{attrs:{label:"标签选项"}},t._l(t.tagList,function(e,s){return i("Tag",{attrs:{name:e.name},nativeOn:{click:function(i){t.select(e)}}},[t._v(t._s(e.name))])})),i("FormItem",{attrs:{label:"选择公号",prop:"codes"}},[i("CheckboxGroup",{model:{value:t.codes,callback:function(e){t.codes=e},expression:"codes"}},t._l(t.gonghaoList,function(e,s){return i("Checkbox",{attrs:{label:e.code,name:"codes"}},[t._v(t._s(e.name))])}))],1),i("FormItem",[i("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"success"},on:{click:t.onSave}},[t._v("保存")]),i("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"warning"},on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)},a=[],o=(i("28a5"),i("7f7f"),i("cadf"),i("551c"),i("097d"),{data:function(){var t=this;return{img_path:"",form:{},type:1,subForm:{},editData:[],codes:[],contents:[],task:!1,delay:"",description:"",picMessageSwitch:!1,imgUrl:"",gonghaoList:[],obj:{},contentData:{},channel:0,timing_time:new Date,tagName:"",tagList:[],tagId:"",sex:"all",editHeader:[{key:"title",title:"标题",align:"center"},{key:"picurl",title:"图片",align:"center",render:function(t,e){return t("img",{attrs:{src:e.row.picurl,style:"width:100%;padding:10px;"}})}},{key:"url",title:"链接",align:"center"},{key:"description",title:"详细信息",align:"description",width:100},{title:"Action",align:"center",render:function(e,i){var s=t;return e("div",[e("Button",{style:{marginRight:"10px"},props:{type:"primary",size:"small"},on:{click:function(){s.subForm=i.row,s.subForm.index=i.index,s.imgUrl=i.row.picurl}}},"修改"),e("Button",{props:{type:"error",size:"small"},on:{click:function(){s.$Modal.confirm({title:"提示:",content:"确认删除这条内容吗？",onOk:function(){"messageUpdate"==s.$route.name&&s.editData.length<=1?s.$Message.info("列表中最少展示一条数据"):(s.editData.splice(i.index,1),s.$Message.info("删除成功"))}})}}},"删除")])}}]}},mounted:function(){this.get_codes(),this.showTagList(),"修改客服消息"==this.$route.name&&0!==this.$route.params.contents.length?(this.obj=this.$route.params,this.editData=this.obj.contents,this.type=this.obj.type,this.description=this.obj.contents[0].description,this.subForm=this.editData[0],this.imgUrl=this.subForm.picurl,this.delay=this.obj.delay,this.channel=this.obj.is_timing?2:this.obj.task?1:0,this.timing_time=this.obj.time,this.tagId=this.obj.tagId,this.codes=this.obj.codes,this.sex=this.obj.sex,this.tagId&&this.showList()):"修改客服消息"==this.$route.name&&(this.obj=this.$route.params,this.imgUrl=this.obj.img,this.type=this.obj.type,this.delay=this.obj.delay,this.channel=this.obj.is_timing?2:this.obj.task?1:0,this.timing_time=this.obj.time,this.tagId=this.obj.tagId,this.codes=this.obj.codes,this.sex=this.obj.sex,this.img_path="./public/uploads/"+this.imgUrl.split("http://test.oorggt.top/uploads/")[1],this.tagId&&this.showList())},methods:{handleClose:function(){this.tagName=""},showTagList:function(){var t=this;this.$axios.get("/tag").then(function(e){t.tagList=e.data.data})},select:function(t){this.tagId=t._id,this.tagName=t.name},onSave:function(){var t=this;1==this.type?(this.contentData.description=this.description,this.contents.push(this.contentData)):this.contents=this.editData,"添加客服消息"==this.$route.name?this.$axios.post("/message/create",{contents:this.contents,type:this.type,task:"1"==this.channel,is_timing:"2"==this.channel,delay:this.delay,timing_time:""==this.timing_time?"":this.timing_time,codes:this.codes,img:this.imgUrl,tagId:this.tagId,img_path:this.img_path,sex:this.sex}).then(function(e){e.data.success?(t.reset(),t.$router.push({name:"消息管理"}),t.$Message.info(e.data.success)):t.$Message.info(e.data.err)}):"修改客服消息"==this.$route.name&&this.$axios.post("/message/update",{id:this.obj._id,contents:this.contents,type:this.type,task:"1"==this.channel,is_timing:"2"==this.channel,delay:this.delay,timing_time:""==this.timing_time?"":this.timing_time,codes:this.codes,img:this.imgUrl,tagId:""==this.tagName?"":this.tagId,img_path:this.img_path,sex:this.sex}).then(function(e){e.data.success?(t.reset(),t.$router.push({name:"消息管理"}),t.$Message.info(e.data.success)):t.$Message.info(e.data.err)})},addOne:function(){this.subForm.picurl=this.imgUrl,this.editData.push(this.subForm),this.subForm={},this.imgUrl=""},saveOne:function(){this.editData.splice(this.subForm.index,1,this.subForm),this.subForm={},this.imgUrl=""},changeType:function(){this.reset()},handleSuccess:function(t,e){this.imgUrl="http://test.oorggt.top/uploads/"+t.filename,this.img_path="./public/uploads/"+t.filename},showList:function(){var t=this;this.$axios.get("/tag/get_name",{params:{tagId:this.tagId}}).then(function(e){t.tagName=e.data.data.name})},reset:function(){this.form={},this.subForm={},this.imgUrl="",this.editData=[]},cancel:function(){this.reset(),this.$router.push({name:"消息管理"})},get_codes:function(){var t=this;this.$axios.get("/message/get_code").then(function(e){0!=e.data.data.length&&(t.gonghaoList=e.data.data)})}}}),n=o,r=(i("ef0b"),i("2877")),l=Object(r["a"])(n,s,a,!1,null,"7ba9de1c",null);l.options.__file="editInfo.vue";e["default"]=l.exports},aae3:function(t,e,i){var s=i("d3f4"),a=i("2d95"),o=i("2b4c")("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==a(t))}},ef0b:function(t,e,i){"use strict";var s=i("72ff"),a=i.n(s);a.a}}]);
//# sourceMappingURL=chunk-47a916f2.71a04d8d.js.map